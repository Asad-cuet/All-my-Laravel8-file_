1.create new project    //out-topic kill port cmd command:npx kill-port 3306.kill app:tasklist>Taskkill /PID 4132 /F

2.connect database

3.create ui system  //don't migrate now

4.modify user migration:

      add:$table->tinyInteger('role_as')->default('0');

      //for placeOrder
      $table->string('fname')->default(null);
      $table->string('lname')->default(null);
      $table->string('phone')->default(null);
      $table->string('address1')->default(null);
      $table->string('address2')->default(null);
      $table->string('city')->default(null);
      $table->string('state')->default(null);
      $table->string('country')->default(null);
      $table->string('pincode')->default(null); 


5.migrate now


6.admin middleware:

      php artisan make:middleware AdminMiddleware


7.replace in middleware:

      use Illuminate\Support\Facades\Auth;
      public function handle($request, Closure $next)
    {
        if(Auth::check())
        {
            if(Auth::user()->role_as == '1')
            {
                return $next($request);
            }
            else
            {
                return redirect('/home')->with('status','Access Denied! as you are not as admin');
            }
        }
        else
        {
            return redirect('/home')->with('status','Please Login First');
        }
    }


   


8.Kernel.php:


    protected $routeMiddleware = [

        'isAdmin' => \App\Http\Middleware\AdminMiddleware::class, //Add to the end
    ];


9.Controllers/Auth/LoginController.php:

       comment $redirectTo

       paste:   
     use Illuminate\Support\Facades\Auth; 
    protected function authenticated()
    {
        if(Auth::user()->role_as == '1') //1 = Admin Login
        {
            return redirect('dashboard')->with('status','Welcome to your dashboard');
        }
        elseif(Auth::user()->role_as == '0') // Normal or Default User Login
        {
            return redirect('/')->with('status','Logged in successfully');
        }
    }


     import Auth class [click>right-button,import class]


10.web.php:

      Route::middleware(['auth','isAdmin'])->group(function () {

            Route::get('/dashboard', function () {
                 return view('admin.dashboard');   //temporally use:return "Admin Login";
                                  });

          });

11.edit role_as value in user table.create a new user as normal user

Note:Now admin login redirect to different route from user


12.Integrate Admin Dashboard:

     template link:https://github.com/creativetimofficial/material-dashboard-bs4
     web link:https://demos.creative-tim.com/

     new file:views/layouts/admin.blade.php

     new folder:public/admin/css/:paste template 'material..css'

     new folder:public/admin/js/:paste template core js all' and plugin/perfect-scrollbar.jqu..js


     new:layout/inc/
            sidebar.blade.php:paste sidebar   modify tilte, replace href="#"
            adminnav.blade.php:paste navbar
            adminfooter.blade.php:paste footer


     admin.blade.php:                      // asset('') redirect:public/
             copy paste from app.blade.php 
             clear body
             replace font link from template dashboard
             replace css links
             take <div class="wrapper">all content here</div>
             @include('layouts.inc.sidebar')
             <div class="main-panel">
             @include('layouts.inc.adminnav')
             <div class="content">@yield('content')</div>                  <!-- includinh blade component -->
             @include('layouts.inc.adminfooter')
             </div>

             paste core js files (all).modify src value
             @yield('scripts')


     new:views/admin/dashboard.blade.php:
             @extends('layouts.admin')                                     <!-- showing main component  -->
             
             @section('content')
                 .card>.card-body><h1>Welcome to dashboard</h1>
             @endsection

    replace logout button from app.blade.php with <form>

Note:get login as admin



13.Add Category table+Page:

     php artisan make:model Category -m

     paste on migration:
       $table->string('name');
       $table->string('slug');
       $table->longText('description');
       $table->tinyInteger('status')->default('0');
       $table->tinyInteger('popular')->default('0');
       $table->string('image')->default(null);
       $table->string('meta_title');
       $table->string('meta_descript');
       $table->string('meta_keywords');


     model:
         protected $table='categories';
         protected $fillable=['name','slug','description','status','popular','image','meta_title','meta_descrip','meta_keywords'];


     php artisan migrate

     new:views/admin/category/index.blade.php:
             @section('content')
                 .card>.card-body><h1>Cateogry</h1>
             @endsection


     php artisan make:controller Admin/CategoryController:
                 index() {
                    return view('admin.category.index');
                          }

     php artisan make:controller Admin/DashboardController:
                 index() {
                    return view('admin.dashboard');
                          }


     edit:

        Route::get('/dashboard','Admin\DashboardController@index');

     add:
        Route::get('/categories','Admin\CategoryController@index');

 
     register controller for not include class:
          providers/RouteServiceProvider.php: uncomment $namespace


     edit sidebar>category url:
                  href="{{ url('/categories') }}"
 


14.Integrate Category with your ajax


15.Active navbar button:<li class="{{Request::is('categories') ? 'active':'' }}">  //if url=/categories


16.Add Product table+page:


      php artisan make:model Product -m



      migration:
                $table->bigInteger('cate_id');
                $table->string('name');
                $table->string('slug')->default(null);
                $table->mediumText('small_description');
                $table->longText('description');
                $table->integer('original_price');
                $table->integer('selling_price');
                $table->string('image')->default(null);
                $table->integer('qty');
                $table->string('tax');
                $table->tinyInteger('status');
                $table->tinyInteger('trending');
                $table->mediumText('meta_title');
                $table->mediumText('meta_keywords');
                $table->mediumText('meta_descript');


      model:
              protected $table='products'; 
              protected $fillable=['cate_id','name','slug','small_description','description','original_price','selling_price','image','qty','tax','status','trending','meta_title','meta_keywords','meta_descript'];



              public function category()  //making relationship
                {
                     return $this->belongsTo(Category::class,'cate_id','id');
                }


     do as Category


     public function insert_form()
        {
            $category=Category::all();
            return view('admin.product.add',['category'=>$category]);
        }   


      <div class="col-md-12 mb-3">
                  <select class="form-select" aria-label="Default select example">
                        <option selected>Open this select menu</option>
                        @foreach($category as $item)
                        <option value="{{$item->id}}">{{$item->name}}</option>
                        @endforeach
                  </select>
       </div>      


       fetch category:
            {{$item->category->name}}   



17.Frontend Layout:

       new:layouts/frontend.blade.php:paste from admin,clear except links,modify link(use bootstrap) location,add on ul class="ms-auto",replace navbar class>dark
       new:viws/frontend/dashboard.blade.php:do as admin dashboard
       new:public/frontend/css & js
       new:layouts/front_inc/:
                           front_navbar.blade.php:use bootstrap,rename,remove fluid class,add on ul class="ms-auto",replace navbar class>dark
                           slider.blade.php:use bootstrap,edit href="assets/images/.."


       include front_inc.navbar in layouts/frontend
       include front.slider in views/frontend/dashboard

       php artisan make:controller Frontend/FrontendController:
                             index() 
                             {
                                     $featured_product=Product::where('trending','1')->take(15)->get();
                                     return view('frontend/dashboard',['feteaured_product'=>$featured_product]);
                             }
 
       web.php:
               Route::get('/','Frontend/FrontendController@index');



18.Product Slider:[web link:https://owlcarousel2.github.io/OwlCarousel2/]

    include in layouts/frontend:
       <link rel="stylesheet" href="owlcarousel/owl.carousel.min.css">
       <link rel="stylesheet" href="owlcarousel/owl.theme.default.min.css">

       <script src="jquery.min.js"></script>  
       <script src="owlcarousel/owl.carousel.min.js"></script>


    dashboard.blade.php:

    <div class="py-5">
      <div class="container">
            <div class="row">
                  <h2>Feteared Product</h2>
                  <div class="owl-carousel featured-carousel owl-theme">
                        @foreach ($feteaured_product as $item)
                              <div class="item">
                                    <div class="card">
                                          <img src="{{asset('assets/uploads/product/'.$item->image)}}" alt="Product Image">
                                          <div class="card-body">
                                                <h5>{{$item->name}}</h5>
                                                <span class="float-start">{{$item->selling_price}}</span>
                                                <span class="float-end"><s>{{$item->original_price}}</s></span>
                                          </div>
                                    </div>
                              </div>
                        @endforeach
                  </div>
            </div>
      </div>
    </div>


     also:
            @section('scripts')
            <script>
                  $('.featured-carousel').owlCarousel({
                        loop:true,
                        margin:10,
                        responsiveClass:true,
                        responsive:{
                        0:{
                              items:1,
                              nav:true
                        },
                        600:{
                              items:3,
                              nav:false
                        },
                        1000:{
                              items:5,
                              nav:true,
                              loop:false
                        }
                        }
                  })

            </script> 
            @endsection


19.All category page:


             add in navbar

             new:frontend/category.blade.php:add web,cont.
            
   cont:
    public function category() 
    {
        $category=Category::all();
        return view('frontend/category',['category'=>$category]);

    }


   category-blade shape:


<div class="py-5">
      <div class="container">
            <div class="row">
                  <h2>All Categories</h2>
                  
                        @foreach ($category as $item)
                             
                              <div class="col-md-3 mb-3">
                                    <a href="{{url('category/'.$item->slug)}}" >
                                    <div class="card">
                                          <img src="{{asset('assets/uploads/category/'.$item->image)}}" alt="Product Image">
                                          <div class="card-body">
                                                <h5>{{$item->name}}</h5>
                                          </div>
                                    </div>
                                    </a>
                              </div>
                        @endforeach
                  
            </div>
      </div>
</div>






20.view-category:

             new:frontend/view-category.blade.php:add web,cont.

   cont:
    public function view_category($slug) 
    {
        if($category=Category::where('slug',$slug)->exists())
        {
            $category=Category::where('slug',$slug)->first();
            $product=Product::where('cate_id',$category->id)->orderBy('id','DESC')->get();
            return view('frontend/view-category',['product'=>$product,'category'=>$category]);
        }
        else
        {
            return view('frontend/dashboard')->with("status","Slug doesn't exist");
        }
        

    }
 

<div class="py-5">
      <div class="container">
            <div class="row">
                  <h2>{{$category->name}}</h2>
                 
                        @foreach ($product as $item)
                              <div class="col-md-3 mb-3">
                                    <a href="{{url('category/'.$item->category->slug.'/'.$item->slug)}}">
                                    <div class="card">
                                          <img src="{{asset('assets/uploads/product/'.$item->image)}}" alt="Product Image">
                                          <div class="card-body">
                                                <h5>{{$item->name}}</h5>
                                                <span class="float-start">{{$item->selling_price}}</span>
                                                <span class="float-end"><s>{{$item->original_price}}</s></span>
                                          </div>
                                    </div>
                                    </a>      

                              </div>
                        @endforeach
                  
            </div>
      </div>
</div>


21.Add trending category in dashboard:

           cont:
    public function index() 
    {
        $feteared_product=Product::where('trending','1')->take(15)->get();
        $trending_category=Category::where('popular','1')->take(15)->get();
        return view('frontend/dashboard',['feteaured_product'=>$feteared_product,'trending_category'=>$trending_category]);

    }
  
   paste feteaured product box in dashboard blade


22.Make view-product:

       new:viws/frontend/view-product.blade.php

       <a href="{{url('category/'.$item->category->slug.'/'.$item->slug)}}">

       web:Route::get('category/{cate_slug}/{prod_slug}','Frontend\FrontendController@view_product');


  cont:
    public function view_product($cate_slug,$prod_slug)
    {
        if(Category::where('slug',$cate_slug)->exists())
        {
            if(Product::where('slug',$prod_slug->exists))
            {
                $product=Product::where('slug',$prod_slug)->first();
                return view('frontend/view-product',['product'=>$product]);
            }
            else
            {
                return view('frontend/view-product')->with('status','No such product found');
            }
        }
        else
        {
        return view('frontend/view-product')->with('status','No such Category found');
        }
    }

   blade box:

@section('content')
 <div class="py-3 mb-4 shadow-sm bg-warning border-top">
      <div class="container">
            <h6 class="mb-0">{{$product->category->name}}</h6>      
      </div>       
</div>      


<div class="container">
      <div class="card shadow product_data">
            <div class="card-body">
                  <div class="row">
                        <div class="col-md-4 border-roght">
                              <img src="{{asset('assets/uploads/product/'.$product->image)}}" alt="image" class="w-100">
                        </div>
                        <div class="col-md-8">
                              <h2 class="mb-0">
                                    {{$product->name}}
                                    <label style="font-size:16px;" class="float-end badge bg-danger trending_tag">{{$product->trending==1 ? 'Trending':''}}</label>
                              </h2>
                              <hr>
                              <label class="me-3">Original Price: <s>Rs {{$product->original_price}}</s></label>
                              <label class="fw-bold">Selling Price: Rs {{$product->selling_price}}</label>
                              <p class="mt-3">
                                    {{$product->small_description}}     
                              </p>
                              <hr>
                              @if($product->qty>0)
                                    <label class="badge bg-success">In stock</label>
                              @else       
                                    <label class="badge bg-danger">Out of stock</label> 
                              @endif
                              <div class="row mt-2">
                                     <div class="col-md-3">
                                                <input type="hidden" value="{{$product->id}}" class="prod_id">
                                                <label for="quantity">Quantity</label>
                                                <div class="input-group text-center mb-3" style="width:130px;">
                                                       <button class="input-group-text decrement-btn">-</button>
                                                       <input type="text" name="quantity" value="1" class="form-control qty-input text-center" />
                                                       <button class="input-group-text increment-btn">+</button>      
                                                </div>       
                                    </div> 
                                    <div class="col-md-9">
                                          <br/>
                                          @if($product->qty>0)
                                          <button type="button" class="btn btn-primary me-3 float-start  addToCartBtn">Add to Cart <i class="fa fa-shopping-cart"></i></button>                                          
                                          @else       
                                          <button type="button" class="btn btn-success me-3 float-start">Add to Wishlist <i class="fa fa-heart"></i></button>
                                          @endif
                                           
                                                
                                    </div>     
                              </div>      
                        </div>
                  </div>
            </div>
      </div>
</div>


@endsection




23.Integrate Google fonts and font awesome:
 
     in layouts.frontend.blade.php:
                  <link rel="preconnect" href="https://fonts.googleapis.com">
                  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
                  <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">


                  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/fontawesome.min.css" integrity="sha384-jLKHWM3JRmfMU0A5x5AkjWkw/EYfGUAGagvnfryNV3F9VqM98XiIH7VBGVoxVSc7" crossorigin="anonymous">

    add after Add to Wishlist<i class="fa fa-heart"></i>
    add after Add to Cart<i class="fa fa-shopping-cart"></i>


24.Button Increment decrement:


       add class=decrement-btn/increment-btn
       add on input class="qty qty-input"


   <script>
   $(document).ready(function(){
         $('.increment-btn').click(function(e){
               e.preventDefault();

               var inc_value=$('.qty-input').val();
               var value=parseInt(inc_value,10);
               value=isNaN(value) ? 0:value;
               if(value<10)
               {
                     value++;
                     $('.qty-input').val(value);
               }
         });


         $('.decrement-btn').click(function(e){
               e.preventDefault();

               var dec_value=$('.qty-input').val();
               var value=parseInt(dec_value,10);
               value=isNaN(value) ? 0:value;
               if(value>1)
               {
                     value--;
                     $('.qty-input').val(value);
               }
         });
   });
   </script>
       



25.Add to Cart activate:

      php artisan make:model Cart -m

      migration:
          $table->string('user_id');
          $table->string('prod_id');
          $table->string('prod_qty');

     model:
      protected $table='carts';
      protected $fillable=['user_id','prod_id','prod_qty'];
    public function product()  //making relationship
    {
         return $this->belongsTo(Product::class,'prod_id','id');
    }

     migrate now

     php artisan make:contrller Frontend/CartController


     view_product.blade.php:
          add:
             input class="addToCartBtn"
             add beside card class="product_data"
             <input type="hidden" value="{{$product->id}}" class="prod_id">
              


          <script>   
         $('.addToCartBtn').click(function(e){
               e.preventDefault();
               var product_id=$(this).closest('.product_data').find('.prod_id').val();
               var product_qty=$(this).closest('.product_data').find('.qty-input').val();
               

               $.ajaxSetup({     //has extra code on head:<meta name="csrf-token" content="{{ csrf_token() }}">
                  headers: {
                        'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
                  }
               });


               $.ajax({
                     method:"POST",
                     url:"/add-to-cart",
                     data:{
                           'product_id':product_id,
                           'product_qty':product_qty,
                     },
                     success:function(response) {
                          swal(response.status);
                     }
               });
            });
         </script>

    
    web:Route::post('/add-to-cart','Frontend\CartController@addProduct');


    cont:

    use Illuminate\Support\Facades\Auth;
    public function addProduct(Request $request)
    {
          $product_id=$request->input('product_id');
          $product_qty=$request->input('product_qty');

          if(Auth::check())
          {
              $prod_check=Product::where('id',$product_id)->first();
              if($prod_check)
              {
                  if(Cart::where('prod_id',$product_id)->where('user_id',Auth::id())->exists())
                  {
                    return response()->json(['status'=>$prod_check->name.' Already Added to Cart']);
                  }
                  else
                  {
                  $cartItem=new Cart();
                  $cartItem->user_id=Auth::id();
                  $cartItem->prod_id=$product_id;
                  $cartItem->prod_qty=$product_qty;
                  $cartItem->save();
                  return response()->json(['status'=>$prod_check->name.' Added to Cart']);
                  }
              }
          }
          else
          {
              return response()->json(['status'=>'Login to Continue']);
          }
    }


26.Add login registrate user button on navbar from app.blade.php,home button from welcome.blade.php



27.Cart Page+increment/drement+remove button:
    
***     add cart button on navbar

***     new:views/frontend/cart.blade.php: //layout given in next point



***    public function viewCart()
    {
        $product=Cart::orderBy('id','DESC')->get();
        return view('frontend.cart',['product'=>$product]);
    }


****     script:   //this incre/decre script you can use also in view-product.better you should take all it in custom.js file.I took

<script>
$('.increment-btn').click(function(e){
      e.preventDefault();

      var inc_value=$(this).closest('.product_data').find('.qty-input').val();
      var value=parseInt(inc_value,10);
      value=isNaN(value) ? 0:value;
      if(value<10)
      {
            value++;
            $(this).closest('.product_data').find('.qty-input').val(value);
      }
});


$('.decrement-btn').click(function(e){
      e.preventDefault();

      var dec_value=$(this).closest('.product_data').find('.qty-input').val();
      var value=parseInt(dec_value,10);
      value=isNaN(value) ? 0:value;
      if(value>1)
      {
            value--;
            $(this).closest('.product_data').find('.qty-input').val(value);
      }
});


$('.delete-cart-item').click(function(e){
      e.preventDefault();

      var cart_id=$(this).closest('.product_data').find('.cart_id').val();

      $.ajaxSetup({
                  headers: {
                        'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
                  }
      });



      $.ajax({
            method:"POST",
            url:"/delete-cart-item",
            data:{
                  'cart_id':cart_id
            },
            success:function(response) {
                swal("",response.status, "success");
            }
      });

});

</script>


****  web:

Route::middleware('auth')->group(function() {
    Route::get('/cart','Frontend\CartController@viewCart')->name('cart');
    Route::post('/delete-cart-item','Frontend\CartController@deleteCartItem');
});

 
 
****  cont:


    public function viewCart()
    {
        $product=Cart::where('user_id',Auth::id())->orderBy('id','DESC')->get();
        return view('frontend.cart',['product'=>$product]);
    }


    public function deleteCartItem(Request $request)
    {
        $cart_id=$request->input('cart_id');
        $cartItem=Cart::where('id',$cart_id)->first();
        $cartItem->delete();
        return response()->json(['status'=>'Product Deleted Successfully']);
    }
        



28.Count price and update quantity:


***   cart.blade.php:




<div class="container my-5">
      <div class="card shadow">
            @if($product->count()>0)
            <div class="card-body">
                  @php $total=0; @endphp
                  @foreach ($product as $item)
                  <div class="row product_data">
     
                        <div class="col-md-2 my-auto">
                              <img src="{{asset('assets/uploads/product/'.$item->product->image)}}" height="70px" width="70px" alt="Image">
                        </div>
                        <div class="col-md-3 my-auto">
                            <h6>{{$item->product->name}}</h6>
                        </div>
                        <div class="col-md-2 my-auto">
                            <h6>Rs {{$item->product->selling_price}}</h6>
                        </div>
                        <div class="col-md-3 my-auto">
                              <input type="hidden" value="{{$item->id}}" class="cart_id">
                              @if($item->product->qty >= $item->prod_qty)
                              <label for="quantity">Quantity</label>
                              <div class="input-group text-center mb-3" style="width:130px;">
                                     <button class="input-group-text changeQuantity decrement-btn">-</button>
                                     <input type="text" name="quantity" value="{{$item->prod_qty}}" class="form-control qty-input text-center" />
                                     <button class="input-group-text changeQuantity increment-btn">+</button>      
                              </div>  
                              @php $total+=($item->product->selling_price)*($item->prod_qty); @endphp
                              @else
                                  <h6>Out of Stock</h6>                                  
                              @endif
                        </div>
                        <div class="col-md-2 my-auto">
                              <button class="btn btn-danger delete-cart-item"><i class="fa fa-trash"></i>Remove</button>
                        </div>
                         
                  </div>
                 
                  
                  @endforeach
            </div>
            <div class="card-footer">
                  <h6>Total Price : Rs <span class="total">{{$total}}</span></h6>
                  <a href="{{url('/checkout')}}" class="btn btn-outline-success float-end">Proceed to Checkout</a>
            </div>
            @else
            <div class="card-body text-center">
                  <h2>Your <i class="fa fa-shopping-cart"> Cart is empty</i></h2>
                  <a href="{{url('/category')}}" class="btn btn-outline-primary float-end">Continue Shoppinh</a>
            </div>
            @endif
      </div>
</div>


***   script:
       <script>
            $('.changeQuantity').click(function(e){
                  e.preventDefault();

                  var cart_id=$(this).closest('.product_data').find('.cart_id').val();
                  var qty=$(this).closest('.product_data').find('.qty-input').val();

                  $.ajax({
                        method:"POST",
                        url:"/update-cart",
                        data:{
                              'cart_id':cart_id,
                              'prod_qty':qty,
                        },
                        success:function(response) {
                        if(response.status=='out_of_stock')
                        {
                              swal("Out of stock.Increment Failed");
                        }
                        else 
                        {
                              $('.total').html(response.status);
                        }
                        
                        //console.log(response.status);
                        }
                  });

            });
      </script>


***   web inside 'auth' middleware:Route::post('/update-cart','Frontend\CartController@updateCart');



***   cont:

    public function updateCart(Request $request)
    {
        $cart_id=$request->input('cart_id');
        $prod_qty=$request->input('prod_qty');
        if(Cart::where('id',$cart_id)->exists())
        {
            $cart=Cart::where('id',$cart_id)->first();
            if(($cart->product->qty) >= ($prod_qty))
            {
                $cart->prod_qty=$prod_qty;
                $cart->update();
     
                $cart2=Cart::where('user_id',Auth::id())->get();
                $total=0;
                foreach($cart2 as $item)
                {
                     $total+=($item->product->selling_price)*($item->prod_qty);
                } 
                return response()->json(['status'=>$total]);
            }
            else
            {
                return response()->json(['status'=>'out_of_stock']);
            }

        }
    }


29.Checkout page:

     new:views/frontend/checkout.blade.php

     php artisan make:controller Frontend/CheckoutController

    web inside auth:Route::get('/checkout','Frontend\CheckoutController@index');

    cont:

    public function index()
    {
        $old_cartitems=Cart::where('user_id',Auth::id())->get();
        
        foreach($old_cartitems as $item)
        {
            if(Product::where('id',$item->prod_id)->where('qty','<',$item->prod_qty)->exists())
            {
             //   $p=Product::where('id',$item->prod_id)->where('qty','<',$item->prod_qty)->first();
           //    dd($p->qty);
                $removeItem=Cart::where('user_id',Auth::id())->where('prod_id',$item->prod_id)->first();
                $removeItem->delete();
            }
        }

        $cartitems=Cart::where('user_id',Auth::id())->get();
        return view('frontend/checkout',['cartitems'=>$cartitems]);
    }


   layout:next point


30.placeorder:

   php artisan make:model Order -m

   migration:
      $table->integer('user_id');
      $table->string('fname');
      $table->string('lname');
      $table->string('email');
      $table->string('phone');
      $table->string('address1');
      $table->string('address2')->default(null);
      $table->string('city');
      $table->string('state');
      $table->string('country');
      $table->string('pincode');
      $table->longInteger('total_price')->default(null);
      $table->tinyInteger('status')->default('0');
      $table->string('message')->default(null)();
      $table->string('tracking_no');  //randomely

   model:
      protected $table='orders';
      protected $fillable=['user_id','fname','lname','email','phone','address1','address2','city','state','country','pincode','totoal_price','status','message','tracking_no'];


   php artisan make:model OrderItem -m

   migration:
      $table->string('order_id');  //relation with Order>id
      $table->string('prod_id');
      $table->integer('qty');
      $table->integer('price');
  
   model:
      protected $table='order_items';
      protected $fillable=['order_id','prod_id','price','qty'];
 
   php artisan migrate    

   web in auth:Route::get('/place-order','Frontend\CheckoutController@placeOrder');

  
   layout:

<div class="container mt-5">
   <form action="{{url('/place-order')}}" method="POST">
      @csrf  
      <div class="row">
            <div class="col-md-5">
                  <div class="card">
                        <div class="card-body">
                              <h6>Basic Details</h6>
                              <hr>
                              <div class="row checkout-form">
                                    <div class="col-md-6">
                                          <label for="">First Name</label>
                                          <input required type="text" name="fname" value="{{Auth::user()->fname}}" class="form-control" placeholder="Enter First Name">
                                    </div>
                                    <div class="col-md-6">
                                          <label for="">Last Name</label>
                                          <input required type="text" name="lname" value="{{Auth::user()->lname}}" class="form-control" placeholder="Enter Last Name">
                                    </div>
                                    <div class="col-md-6 mt-3">
                                          <label for="">Email</label>
                                          <input required type="email" name="email" value="{{Auth::user()->email}}" class="form-control" placeholder="Enter Email">
                                    </div>
                                    <div class="col-md-6 mt-3">
                                          <label for="">Phone number</label>
                                          <input required type="text" name="phone" value="{{Auth::user()->phone}}" class="form-control" placeholder="Enter Phone Number">
                                    </div>
                                    <div class="col-md-6 mt-3">
                                          <label for="">Address 1</label>
                                          <input required type="text" name="address1" value="{{Auth::user()->address1}}" class="form-control" placeholder="Enter Address 1">
                                    </div>
                                    <div class="col-md-6 mt-3">
                                          <label for="">Address 2</label>
                                          <input type="text" name="address2" value="{{Auth::user()->address2}}" class="form-control" placeholder="Enter Address 2">
                                    </div>
                                    <div class="col-md-6 mt-3">
                                          <label for="">City</label>
                                          <input required type="text" name="city" value="{{Auth::user()->city}}" class="form-control" placeholder="Enter City">
                                    </div>
                                    <div class="col-md-6 mt-3">
                                          <label for="">State</label>
                                          <input required type="text" name="state" value="{{Auth::user()->state}}" class="form-control" placeholder="Enter State">
                                    </div>
                                    <div class="col-md-6 mt-3">
                                          <label for="">Country</label>
                                          <input required type="text" name="country" value="{{Auth::user()->country}}" class="form-control" placeholder="Enter Country">
                                    </div>
                                    <div class="col-md-6 mt-3">
                                          <label for="">Pin Code</label>
                                          <input required type="password" name="pincode" value="{{Auth::user()->pincode}}" class="form-control" placeholder="Enter Pin Code">
                                    </div>
                              </div>
                        </div>
                  </div>
            </div>
            <div class="col-md-7">
                  <div class="card">
                        <div class="card-body">
                              Order Details
                              <hr>
                              <table class="table table-striped table-bordered">
                                    <thead>
                                          <tr>
                                                <th>Name</th>
                                                <th>Qty</th>
                                                <th>Price</th>
                                          </tr>
                                    </thead>
                                    <tbody>
                                          @php $total=0; @endphp
                                          @foreach ($cartitems as $item)
                                              <tr>
                                                    <td>{{$item->product->name}}</td>
                                                    <td>{{$item->prod_qty}}</td>
                                                    <td>{{$item->product->selling_price}}</td>
                                              </tr>
                                          @php $total+=($item->product->selling_price)*($item->prod_qty); @endphp    
                                          @endforeach
                                    </tbody>
                              </table>
                              <h6>Total : Rs {{$total}}</h6>
                              <hr>
                              <button type="submit " class="btn btn-primary w-100">Place Order</button>
                        </div>
                  </div>
            </div>
      </div> 
   </form>   
</div>



   cont:

    public function placeOrder(Request $request)
    {

         if(!Cart::where('user_id',Auth::id())->exists())
         {
            return redirect('/')->with('status','Add Product to Cart first!');
         }

         $cartitems=Cart::where('user_id',Auth::id())->get();
         $total_price=0;
         foreach($cartitems as $item)
         {
             $total_price+=($item->product->selling_price) * ($item->prod_qty);

         }     


         $order=new Order();
         $order->user_id = Auth::id();
         $order->fname = $request->input('fname');
         $order->lname = $request->input('lname');
         $order->email = $request->input('email');
         $order->phone = $request->input('phone');
         $order->address1 = $request->input('address1');
         $order->address2 = $request->input('address2');
         $order->city = $request->input('city');
         $order->state = $request->input('state');
         $order->country = $request->input('country');
         $order->pincode = $request->input('pincode');
         $order->total_price = $total_price;
         $order->tracking_no = 'asad'.rand(1111,9999);
         $order->save();
         foreach($cartitems as $item)
         {
             OrderItem::create([
                 'order_id'=>$order->id,
                 'prod_id'=>$item->prod_id,
                 'qty'=>$item->prod_qty,
                 'price'=>$item->product->selling_price,
             ]);

             //reducing quantity
             $prod=Product::where('id',$item->prod_id)->first();
             $prod->qty=$prod->qty - $item->prod_qty;
             $prod->update();
         }   
         
         
         if(Auth::user()->address1==NULL)
         {
             $user=User::where('id',Auth::id())->first();
             $user->fname = $request->input('fname');
             $user->lname = $request->input('lname');
             $user->phone = $request->input('phone');
             $user->address1 = $request->input('address1');
             $user->address2 = $request->input('address2');
             $user->city = $request->input('city');
             $user->state = $request->input('state');
             $user->country = $request->input('country');
             $user->pincode = $request->input('pincode');
             $user->update();
         }

         $cartitems=Cart::where('user_id',Auth::id())->get();
         Cart::destroy($cartitems);

         return redirect('/')->with('status','Order Placed Successfully');
         
    }


   





